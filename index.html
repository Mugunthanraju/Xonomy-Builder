<html
  xmlns="https://mugunthanraju.github.io/Xonomy-Builder/"
  lang="en"
  xml:lang="en"
>
  <head>
    <title>Xonomy Generator</title>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="./Script/main.js"></script>
    <script type="text/javascript" src="./Script/dtd2xonomy.js"></script>
    <link type="text/css" rel="stylesheet" href="./Static/style.css" />
    <script type="text/javascript">
      var testdtdData;
      var wndtdData;
      $(function () {
        $.ajax({
          url: "wn.dtd",
          success: function (file_content) {
            wndtdData = file_content;
            changeDtd();
          },
        });
        $.ajax({
          url: "test.dtd",
          success: function (file_content) {
            testdtdData = file_content;
          },
        });
      });
      function changeDtd() {
        var dtdradio = $("input[name=dtddata]:checked").val();
        var dtddata = testdtdData;
        switch (dtdradio) {
          case "wn":
            var dtddata = wndtdData;
            break;
          case "kemd":
            var dtddata = kemdDtd;
            break;
        }
        $("#dtd").val(dtddata);
        updateEditor();
      }
      function updateEditor() {
        var dtdData = $("#dtd").val();
        var xmlStructure = parseDTD(dtdData);
        var xmlDoc = initialDocument(xmlStructure);
        var spec = struct2Xonomy(xmlStructure);
        var xema = struct2Xema(xmlStructure);
        $("#xema").val(JSON.stringify(xema, undefined, 1));
        var editor = document.getElementById("editor");
        Xonomy.lang = "en";
        Xonomy.render(xmlDoc, editor, spec);
      }
    </script>
  </head>
  <body>
    <h1>Xonomy Generator</h1>
    <label
      ><input
        type="radio"
        name="dtddata"
        value="test"
        onclick="changeDtd()"
        checked="checked"
      />Conversion of DTD to Xonomy</label
    >
    <!-- <label
      ><input
        type="radio"
        name="dtddata"
        value="wn"
        onclick="changeDtd()"
        checked="checked"
      />wordnet</label
    > -->
    <br />
    <div style="float: left; margin-right: 5em">
      DTD<br />
      <textarea id="dtd" rows="15" cols="350"></textarea>
    </div>

    <div>
      <label for="input-file">OR</label><br />
      <input type="file" id="input-file" accept=".txt,.dtd" />
    </div>

    <!-- <div style="">
Xema<br>
<textarea id="xema" rows="15" cols="50" disabled="disabled">
</textarea>
</div> -->
    <br />
    <!-- <input type="file" id="js-file" accept=".txt,.dtd"> -->
    <div>
      <h3>Click below button</h3>
    </div>

    <input type="button" value="Generate Xonomy" onclick="updateEditor()" />
    <div class="">
      <div id="editor"></div>
    </div>

    <script>
      document.getElementById("input-file").addEventListener("change", getFile);
      function getFile(event) {
        const input = event.target;
        if ("files" in input && input.files.length > 0) {
          placeFileContent(document.getElementById("dtd"), input.files[0]);
        }
      }

      function placeFileContent(target, file) {
        readFileContent(file)
          .then((content) => {
            target.value = content;
          })
          .catch((error) => console.log(error));
      }

      function readFileContent(file) {
        const reader = new FileReader();
        return new Promise((resolve, reject) => {
          reader.onload = (event) => resolve(event.target.result);
          reader.onerror = (error) => reject(error);
          reader.readAsText(file);
        });
      }
    </script>
  </body>
</html>
